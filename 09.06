using System;
using System.Net.Sockets;
using System.Text;
using System.Threading.Tasks;

class Program
{
    static async Task Main()
    {
        using TcpClient client = new TcpClient();
        await client.ConnectAsync("127.0.0.1", 5000); // IP и порт сервера
        using NetworkStream stream = client.GetStream();

        var buffer = new byte[1024];
        while (true)
        {
            int bytesRead = await stream.ReadAsync(buffer, 0, buffer.Length);
            if (bytesRead == 0) break; // Сервер закрыл соединение
            string message = Encoding.UTF8.GetString(buffer, 0, bytesRead);
            Console.WriteLine($"Получено: {message}");
        }
    }
} 




using System;
using System.Net;
using System.Net.Sockets;
using System.Text;
using System.Threading.Tasks;

class Program
{
    static async Task Main()
    {
        var listener = new TcpListener(IPAddress.Any, 5000);
        listener.Start();
        Console.WriteLine("Ожидание клиента...");

        using TcpClient client = await listener.AcceptTcpClientAsync();
        Console.WriteLine("Клиент подключен.");
        using NetworkStream stream = client.GetStream();

        while (true)
        {
            string message = $"Сообщение от сервера: {DateTime.Now}";
            byte[] data = Encoding.UTF8.GetBytes(message);
            await stream.WriteAsync(data, 0, data.Length);
            Console.WriteLine($"Отправлено: {message}");
            await Task.Delay(5000); // Пауза 5 секунд
        }
    }
}

